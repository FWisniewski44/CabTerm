---
title: "Faktoren der (In-)Stabilität von Minderheitsregierungen in Europa"
author: "Florian Wisniewski"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: TRUE
    number_sections: TRUE
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load libraries and dfs, include=FALSE, echo=FALSE}
# libraries survival analysis
library(survival)
library(survminer)
library(survMisc)
library(simPH)
library(flexsurv)
library(My.stepwise)

# libraries general
library(tidymodels)
library(tidyverse)
library(rms)
library(MASS)
library(corrplot)
library(lubridate)
library(Amelia)
library(xtable)
library(haven)
library(foreign)
library(broom)
library(psych)
library(Hmisc)
library(expss)
library(rockchalk)
library(effects)
library(modeldata)
library(randomForest)
library(compare)
library(psych)
library(desc)
library(PerformanceAnalytics)
library(reshape2)
library(d3heatmap)
library(kableExtra)
library(gtools)

###########################################

# # import relevant dfs
# ## import dta bergmann df
# dtaBerg <- read_dta(file = "/Users/flo/Documents/Uni/Uni Bamberg/WS 2020-21/S Koalitionsforschung/data/cabinets_2019_Bergmann.dta")
# str(dtaBerg)
# # View(dtaBerg)
# head(dtaBerg)
# 
# ## import xls ERDDA df
# erdda <- readxl::read_excel(path = "/Users/flo/Desktop/data/erdda/Data ERD-e_SA_SOE_JH_N-29_2014.xls")
# str(erdda)
# # View(erdda)
# head(erdda)

###########################################

# bergmann and erdda, joined df
BergmannERDDA <- read_dta(file = "/Users/flo/Documents/GitHub/CabTerm/erdda2014-Bergmann2019_merged.dta")
BergmannERDDA <- as_tibble(BergmannERDDA)

# bergmann and erdda, filtered and renamed
load(file = "BergmannERDDA.f.RData")

```

# Einleitung

Minderheitsregierungen stellen in Europa gut ein Drittel der Regierungskabinette dar. Wenn auch in Deutschland selten bis gar nicht vorhanden, so sind diese besonders in Skandinavien eine recht häufig vorkommende, manchmal sogar präferierte Regierungsform - zum Beispiel besonders in Dänemark, aber auch in Norwegen.

Und gerade in diesem Kontext sind angesprochene Minderheitsregierungen hierzulande beinahe sogar verpönt, ein Umstand, der auch aus historischer Perspektive begründet werden könnte - gespeist aus der deutschen Erinnerung an die Weimarer Republik und deren Ende. Minderheitsregierungen gelten deshalb für viele Menschen des Öfteren als instabile und leicht für parlamentarische Angriffe anfällige Regierungen.

Doch wird man dieser Form des Regierens bei der Einnahme eines derartigen Standpunktes in keinem Fall gerecht. Wie bereits angemerkt finden sich in der Realität vor allem im skandinavischen Raum oftmals Minderheitsregierungen an der Macht - und diese sind alles andere als handlungsunfähig. Im Gegenteil: die Notwendigkeit, Gemeinsamkeiten mit außer-koalitionären Partnern herauszuarbeiten und Kompromisse zu schließen kann ebenso belebend auf die parlamentarische Debatte wirken. Minderheitsregierungen gelten dort auch gerade deshalb als Repräsentation der regionalen Mentalität: Kompromisse werden als erstrebenswert erachtet und es wird generell versucht, auch vermeintlich randständige Akteure einzubeziehen. Somit können Minderheitsregierungen auch vorteilhaft sein - für die parlamentarische Integration, aber auch für die dortige Debattenkultur.

Und hierin liegt auch einer der Gründe, weshalb sich innerhalb der Forschung bereits sehr breit mit dem Thema auseinandergesetzt worden ist (vgl. Strøm 1984, 1990). Es kann durchaus angenommen werden, dass Minderheitsregierungen, um funktionieren zu können, eine andere parlamentarische Umgebung benötigen. Wie bereits im Titel vorliegender explorativ-analytischer Arbeit angekündigt, soll dieses Thema auch im Zentrum vorliegender Arbeit wiederfinden: es wird die Frage danach gestellt, welche Faktoren es überhaupt konkret sind, die im Falle von Minderheitsregierungen zu deren Stabilisierung (oder auch Destabilisierung) beitragen?

Vorgegangen werden soll dabei wie folgt: in einem ersten Schritt wird zunächst theoretischer auf diese Thematik eingegangen. Die vorliegende Untersuchung erachtet bezüglich der methodischen Vorgehensweise das Modell Thomas Saalfelds (2008) als einen guten Ausgangspunkt. Dieses soll nun, unter Vorbehalt kleinerer Änderungen, auf einen aus aktuelleren Daten kombinierten Datensatz angewendet werden, welcher ausschließlich auf Minderheitsregierungen gefiltert wurde, um spezifische Aussagen über diese Regierungsform treffen zu können. Nachdem in gebotener Kürze auf die zugrundeliegenden Daten und die verwendete Methodik eingegangen wurde, werden die Ergebnisse präsentiert. Danach wird vorliegende Arbeit ein abschließendes Fazit zur Untersuchung selbst ziehen und besondere Befunde zum Abschluss nochmals herausstellen.


<!-- + debatte im parlament belebt -->
<!-- + norwegen und dänemark -->
<!-- + besondere gegebenheiten, die minority govs brauchen -->

# Theorie

## Das Modell Saalfelds (2008)

Zuerst wird nun also das bereits in der Einleitung angesprochene Vorbildmodell Thomas Saalfelds aus dem Jahr 2008 etwas genauer beleuchtet. Dieses erschien im Rahmen eines Aufsatzes, welcher Teil eines Sammelbandes mit dem generellen Thema Koalitionen und Koalitionsverhandlungen (Strøm et al. 2008) war. Saalfeld selbst beschäftigte sich, wie der Titel seines Texts bereits erkennen lässt, darin mit den Dynamiken und Faktoren, die über das Bestehen oder die Auflösung von Kabinetten entscheiden können. Als Rechtfertigung für seine Analyse führt er dreierlei Gründe an: Erstens wolle er Theorie (vgl. Lupia/Strøm 1995, 2008) mit Empirie besser verknüpfen. Bezüglich der empirischen Interpretation, so Saalfeld, seien die Ansätze der Transaktionskosten-Theorie und der akteurszentrierten Institutionsanalyse für ihn interessant gewesen.
Zweitens fügt er hinzu, dass es bis zu dem damaligen Zeitpunkt noch keinen umfassenden Datensatz gab, mit dem eine solche Untersuchung überhaupt vorher möglich gewesen wäre. Mit dem Datensatz *"Comparative Parliamentary Democracy Data Archive"* (Strøm et al. 2008), welcher gerade für diesen Sammelband zusammengestellt wurde, lag dieser Datensatz jetzt vor.
Schließlich kommt er drittens noch auf das generell diesem Sammelband inhärente Konzept der Kosten-Nutzen-Rechnung der Akteure zu sprechen, welche auch er in sein Modell einbinden wollte (Saalfeld 2008, S. 328f.).

Sein Erkenntnisinteresse bezog sich dabei nun nach Lupia und Strøm (2008) auf den Einfluss verschiedener struktureller, institutioneller, auf der Präferenz von Akteuren basierter und verhandlungstheoretischer Variablen, sowie kritischer exogener Ereignisse auf die Wahrscheinlichkeit der Regierungsbeendigung.

### Theorie-Background Saalfelds
Um auf seinen theoretischen Hintergrund genauer zu sprechen zu kommen, bezieht Saalfeld zunächst einen breiteren Exkurs in die bisherige Forschung und deren Ergebnisse mit ein. Hier merkt er zunächst die Perspektive derjenigen an, welche als Vorgehensweise bei der Erforschung von Regierungsstabilität die gleichen Variablen theoretisch rechtfertigten, wie bei der Regierungsbildung zuvor schon. Dem gegenüber weist er jedoch auch auf die Position der Critical Events-Theorie hin, welche von einem zeitkonstanten Risiko für Regierungsbeendigung ausgeht. Demnach würden diese also aus der Wirkung exogener Schocks heraus beendet werden. (vgl. Saalfeld 2008, S. 332f.)

Saalfeld gibt jedoch gegenüber der Critical Events-Perspektive zu bedenken, dass gerade diese Annahme der Zeitkonstanz des Beendigungsrisikos bereits als widerlegt gilt (er verweist auf Warwick 1994) und zeigt dies auch selbst nochmals graphisch (Saalfeld 2008, S. 338). Damit kann nicht davon ausgegangen werden, dass das Beendigungsrisiko für eine Regierung zu jeder Zeit gleich hoch ist.

Mit Blick auf das zweite Kapitel des Sammelbands (Lupia/Strøm 2008), in dem auch für eine Kombination der bereits angesprochenen Faktoren von Struktur, Präferenzen der Akteure, institutionellen Gegebenheiten und auch kritischer Ereignisse geworben wurde, übernimmt auch Saalfeld diese Herangehensweise.

### Methodik Saalfelds

Für die methodische Umsetzung seines Vorhabens wählte Saalfeld bezüglich des Forschungsdesigns die Herangehensweise eines *competing risks*-Designs mit Hilfe der ereignisanalytischen Methode der *Cox-Proportional-Hazards*-Modelle. Bei diesem Forschungsdesign wird, anstatt eines gemeinsamen Beendigungsrisikos von Regierungen insgesamt, angenommen, dass es aus theoretischer Überlegung heraus in Bezug auf Regierungsbeendigungen durch entweder *vorgezogene Neuwahlen* oder auch *Kabinettsumbildungen* unterschiedlich große Risiken des Scheiterns gibt. Die Herangehensweise über ereignisanalytische Modelle hielt Saalfeld für fruchtbarer, als über einfache Regressionsmodelle, da hier eben auch die Zeitkomponente mit dargestellt und einbezogen werden kann, worin ihm uneingeschränkt zugestimmt werden kann.

Bezüglich des für diese Modelle notwendigen Zensierungs-Regimes orientierte sich Saalfeld an bestehenden Theorien (vgl. Diermeier/Stevenson 1999): für das undifferenzierte Beendigungsrisiko ("pooled hazards") wurden die Fälle nach rechts zensiert. Dies bedeutet, alle Fälle wurden zensiert, welche in den Daten zum Endzeitpunkt der Erhebung noch im Amt waren oder durch technische Gründe beendet wurden (z. B. den Tod des Premiers).
Saalfeld zensierte weiterhin im Fall der Kabinettsumbildungen ("replacement hazards") alle Kabinette, die zeitlich aus dem Rahmen vielen, technisch beendet wurden *oder* durch vorgezogene Neuwahlen nach rechts.
Für die vorgezogenen Neuwahlen ("early elections hazards") selbst wurden umgekehrt die gleiche Operation vorgenommen: es wurden alle zum Ende der Erhebung noch bestehenden Kabinette, sowie technische Beendigungen und Kabinettsumbildungen nach rechts zensiert. Auf diese Weise erhielt Saalfeld die für sein *competing risks*-Forschungsdesign notwendigen, einzelnen Überlebensfunktionen.

### Kurz zu seinen Ergebnissen


<!-- + was genau macht saalfeld? -> modelle rechnen für einzelne bereiche; Aussagen über Faktoren, die das risiko des regierungsscheiterns erhöhen oder senken -->

## Warum Minderheitsregierungen nochmal neu betrachtet werden sollten (Strøm 1984, 1990)

Hier: darlegen, warum die gleiche explorative Datenanalyse auch für ein Subset von NUR Minderheitsregierungen gemacht werden sollte. Dabei auf Strøm v. a. zurückgreifen

## Evtl. als eigener Absatz: was mache ich hier in dieser Arbeit?
Das Ziel vorliegender Arbeit wird es nun sein, Gemeinsamkeiten und Unterschiede im Kontrast zu vor allem Saalfelds Modell herauszuarbeiten. Die Fragen, die sich in diesem Kontext gestellt werden, sind vor allem, wie diese im Vergleich zum "Vorbild"-Modell aussehen, wenn *einzig Minderheitsregierungen* die grundlegenden Daten ausmachen.

Am Forschungsdesign wurde grundlegend nichts wirklich verändert - jedoch werden in der vorliegenden Analyse einzig die "pooled hazards" für die untersuchten Kabinette untersucht. Gerechtfertigt kann dies damit werden, dass 

# Empirie & Untersuchung

## Daten

Im nächsten Schritt soll in aller Kürze auf die in der vorliegenden Arbeit genutzten Datensätze eingegangen werden. Genutzt wurden:

+ einerseits die *Daten von Henning Bergmann* (2019), welche im Rahmen des besuchten Seminars zur Verfügung gestellt wurden,
+ andererseits die Daten aus dem *European Representative Democracy Data Archive (ERDDA)* aus dem Jahr 2014

Diese beiden Datensätze wurden aufgrund ihrer Aktualität und einer Vielzahl für die vorliegende Untersuchung relevanten Variablen ausgewählt. Der ERDDA-Datensatz umfasst im Großen und Ganzen beinahe identische Variablen, wie der von Saalfeld 2008 genutzte CPD-Datensatz - jedoch ist er mit aktuelleren Informationen bestückt.
Für die Untersuchung selbst wurden diese beiden zu einem gemeinsamen Datensatz verschmolzen, welcher dann wiederum im Hinblick auf die Minderheitsregierungen gefiltert wurde. Dies wurde über einen 1:1-merge-Befehl und die Identifikationsvariable "cab_code", welche den einzigartigen Kabinettscode eines Regierungskabinetts beinhaltet, durchgeführt.

Daraufhin wurde der Datensatz auf die im Mittelpunkt des Forschungsinteresses stehenden Minderheitsregierungen gefiltert. Es zeigte sich hier, dass zur Analyse von ursprünglich 640 beobachteten Regierungen im kombinierten Datensatz im Zeitverlauf 207 Minderheitsregierungen als Untersuchungsgegenstände übrig blieben. Dies kann als eine für die Analyse ausreichend große Fallzahl gesehen werden. Darüber hinaus wurde überprüft, ob sich im Datensatz sogenannte "non-partisan cabinets", also Übergangskabinette befinden, jedoch waren in den 207 bereits herausgefilterten Minderheitsregierungen keine mehr davon vorhanden.

## Methodik, Vorgehensweise bei der Untersuchung

Um Vergleichbarkeit zwischen dem Vorbild des Modells von Saalfeld 2008 und den hier geschätzten Modellen zu erreichen, wurde sich logischerweise ebenfalls für die ereignisanalytische Methode der Cox Proportional Hazards-Modelle entschieden. Da in vorliegender Arbeit nur ein pooled hazards-Modell geschätzt wurde, wurden die Daten auch nur für diese Form nach rechts zensiert.

Um die Modellvoraussetzungen zu überprüfen, werden für jedes in der Analyse gerechnete Modell ebenfalls auch die Schoenfeld-Residuen berechnet, um Aussagen über die Proportional Hazards Assumption treffen zu können. Nur wenn bei diesem Test alle in einem Cox-Modell einbezogenen Variablen einen p-Wert > 0.05 aufweisen konnten, d. h. nur bei einem insignifikanten Test für die Proportional Hazards Assumption bei allen Variablen in einem Modell, konnte die Nullhypothese, die PH-Assumption liege nicht vor, abgelehnt werden und das Modell konnte so bestehen bleiben (Grambsch/Therneau 1994).

Ebenso wurden, um schon vorher auf diese Problematik einzugehen, für jedes gerechnete Modell sogenannte "Heatmaps" erstellt, welche die Korrelation der Variablen untereinander darstellen. Diese sind als Graphiken im Anhang beinhaltet. Der [Online-Appendix](https://github.com/FWisniewski44/CabTerm/tree/newLib_test) der Arbeit enthält R-Code für eine interaktive Version dieser Heatmaps, welche zur schnellen Determinierung der Korrelationsmaße enorm hilfreich sind. Auf Grundlage dieser wurden dann, sofern dies der Fall war, hoch miteinander korrelierende Variablen so behandelt, dass immer eine dieser Variablen ausgeschlossen werden sollte. Dabei wurde sich immer für diejenige entschieden, für die ein geringeres Erklärungspotential oder eine geringere theoretische Kongruenz mit den Erklärungsmustern im Hinblick auf das zu rechnende Modell zu erwarten gewesen wäre.
Eine gewisse Vergleichbarkeit der Modelle am Schluss (auch in Relation zum best fit) kann zusätzlich durch die Angabe der AIC-Werte erreicht werden.

<!-- Um Aussagen über die Faktoren von Stabilität oder Instabilität treffen zu können, wurde sich für in der Analyse für ein ereignisanalytisches Vorgehen entschieden. -->

<!-- Innerhalb dieses Bereiches wurde sich für die Cox Proportional Hazards Modelle entschieden: aus den Ergebnissen dieser lässt sich zum Schluss gut herauslesen, welche Faktoren es sind, die letztlich *signifikant* etwas über die Stabilität oder Instabilität der Minderheitsregierungen aussagen können. Dies wird anhand der Hazard Ratios geschehen. -->

<!-- Um die Modellvoraussetzungen zu überprüfen, werden für jedes in der Analyse gerechnete Modell ebenfalls auch die Schoenfeld-Residuen berechnet, um Aussagen über die Proportional Hazards Assumption treffen zu können. Nur wenn bei diesem Test alle in einem Cox-Modell einbezogenen Variablen einen p-Wert > 0.05 aufweisen konnten, d. h. nur bei einem insignifikanten Test für die Proportional Hazards Assumption bei allen Variablen in einem Modell, konnte die Nullhypothese, die PH-Assumption liege nicht vor, abgelehnt werden und das Modell konnte so bestehen bleiben (Grambsch/Therneau 1994). -->

<!-- Ebenso wurden, um schon vorher auf diese Problematik einzugehen, für jedes gerechnete Modell sogenannte "Heatmaps" erstellt, welche die Korrelation der Variablen untereinander darstellen. Hierbei wurden dann, sofern dies der Fall war, hoch korrelierende Variablen so behandelt, dass immer eine dieser Variablen ausgeschlossen werden sollte. Dabei wurde sich immer für diejenige entschieden, für die ein geringeres Erklärungspotential im Hinblick auf das zu rechnende Modell zu erwarten gewesen wäre. -->

## Ergebnisse aus den gerechneten Modellen

Nun soll in diesem Abschnitt auf die gerechneten Modelle selbst eingegangen werden. Um dem Vorbild des Modells von Saalfeld von 2008 zu folgen, wurden, wie bereits in Abschnitt 2.1 zu eben jenem Modell erklärt, für die Bereiche *Struktur*, *Präferenzen*, *Institutionen*, sowie und *Bargaining* und *kritische (exogene) Events* einzelne Modelle gerechnet - mit der Ausnahme der Variablen *discr2019* und *abs_dur*, aus welchen, wie bereits zuvor erwähnt, die Überlebensfunktion gerechnet wurde und mit dem Unterschied, dass die Daten sich rein auf Minderheitsregierungen bezogen. Dafür wurden jedes Mal erneut vom gesamten Datensatz abgespaltene Subsets mit den in den Bereichen fraglichen Variablen verwendet. In Kongruenz zu Saalfeld folgt zum Schluss außerdem noch ein *best fit-Modell*, welches technisch mit einer schrittweisen Errechnung in R unter Orientierung am niedrigsten möglichen AIC-Wert errechnet wurde.

Bei der Diskussion der Modelle wird nun wie folgt vorgegangen: die jeweiligen signifikanten errechneten Koeffizienten in den Modellen dieser Arbeit werden selbstverständlich für sich selbst stehend im Hinblick auf die Auswirkungen für die Stabilität oder Instabilität von Minderheitsregierungen interpretiert. Jedoch wird dies darüber hinaus auch im Vergleich und Rückblick zu den bereits vorhandenen Forschungsergebnissen von Strøm, aber vor allem Saalfeld, geschehen. Bezüglich des Signifikanzniveaus der Variablen im Modell muss noch angemerkt werden, dass vorliegende Arbeit etwas strenger vorgeht, als Saalfeld bei seinem Modell von 2008: während damals als Grenzwert 0,10 angenommen wurde, nimmt diese Arbeit das gängige Signifikanzniveau von 0,05 an.


### Modell 1: Struktur

Zunächst nun also zum ersten Modell vorliegender Arbeit, welches sich mit den Variablen aus dem Bereich *"Struktur"* beschäftigt. Wie schon bei Saalfeld fielen in diesen Bereich Variablen, die sich mit der strukturellen Beschaffenheit der untersuchten Regierungen selbst, aber auch der parlamentarischen Umgebung, in der diese sich bewegen. Für das Modell wurden in den Betrachtungsdatensatz die folgenden Variablen aufgenommen:

+ der Sitzanteil der Regierungspartei(en) im Parlament (*cab_seat_share*),
+ ob ein Kabinett eine Koalition ist (*coal_cab*),
+ die Anzahl der Kabinettsparteien (*num_cabparties*),
+ ob die Partei mit der größten Verhandlungsmacht im Kabinett vertreten war (*max_bargpow_cab*),
+ die maximal mögliche Regierungsdauer (*max_poss_dur*),
+ die effektive Anzahl von Parteien im Kabinett (Laakso/Taagepera 1979, *effec_parties_parl*).

Diese wurden dann, bevor ein Modell geschätzt wurde, auf Korrelationen untereinander getestet. Dabei wurde eine sehr hohe Korrelation der Variablen *coal_cab* und *num_cabparties* entdeckt (0.84). Daraufhin wurde sich dazu entschlossen, die Variable *coal_cab* aus der Modellschätzung auszuschließen. Theoretisch gerechtfertigt werden kann dies dadurch, dass durch *num_cabparties* bereits eine Variable für die Anzahl an Kabinettsparteien beinhaltet ist und, dass bereits im Ursprungs-Datensatz sowohl Ein-Parteien-Minderheitsregierungen, als auch Koalitions-Minderheitsregierungen beinhaltet sind; daher wurde sich von der Variable über die Anzahl der Kabinettsparteien mehr Erklärungskraft erhofft.

Nach dem Ausschluss der hoch korrelierenden Variablen wurde das erste Cox Proportional Hazards-Modell für den Bereich der Strukturvariablen durchgerechnet, welches nun folgende Ergebnisse lieferte

```{r subset structure && model fit part 1: struture, echo=FALSE, message=FALSE, warning=FALSE, paged.print=TRUE}
# sbStructure
sbStructure <- subset(BergmannERDDA.f, select = c("discr2019", "abs_dur", "cab_seat_share",
                                                  "num_cabparties", "max_bargpow_cab",
                                                  "max_poss_dur", "effec_parties_parl"))

# model for structural vars
coxPH.STR <- coxph(data = sbStructure, Surv(time = sbStructure$abs_dur, event = sbStructure$discr2019, type = "right") ~ . - abs_dur - discr2019)

extractAIC(coxPH.STR)
summary(coxPH.STR)
cox.zph(coxPH.STR)
car::vif(coxPH.STR)
```

Aus den Ergebnissen wird zunächst ersichtlich, dass der AIC-Wert des Modells 1243 beträgt. Dies ist zur Vergleichbarkeit mit den anderen Bereichen im Hinterkopf zu behalten.
Weiterhin fällt in der Betrachtung der Signifikanzwerte für die einzelnen untersuchten Variablen auf, dass die *maximal mögliche Regierungsdauer* und auch die *Anzahl effektiver Parteien im Parlament* beide deutlich nicht signifikant und damit nicht interpretierbar sind.
Sehr wohl zu interpretieren sind dagegen die Werte der Variablen *Sitzanteil der Regierungspartei(en) im Kabinett* (rate: -0,04 - ratio: 0,96), *Anzahl der Kabinettsparteien* (0,34 - 1,4) und, ob die *Partei mit der größten Verhandlungsmacht Teil der Regierung* ist (0,59 - 1,8).

Es kann hier für den Sitzanteil der Regierungsparteien konstatiert werden, dass das Risiko einer vorzeitigen Regierungsbeendigung um 4% sinkt, wenn der Sitzanteil des Kabinettes insgesamt sinkt. Dies ist ein zunächst konterintuitiver Befund: man würde eigentlich annehmen, dass bei einem **größeren** Sitzanteil eines Kabinettes die Wahrscheinlichkeit der früheren Beendigung dessen abnehmen würde - und nicht bei einem geringeren. Somit handelt es sich bei einem geringeren Sitzanteil eines Kabinettes um einen Stabilisierungsfaktor, wenn eine Minderheitsregierung vorliegt. Gegenüber den Befunden bei Saalfeld ist dies eine Veränderung: der Sitzanteil der Regierungsparteien im Parlament ist in dessen Modell insignifikant. Somit kann auch gesagt werden, dass dies ein speziell für Minderheitsregierungen relevanter Faktor ist.
<!--hier noch Interpretation fortführen - entweder stimmt was nicht oder es ist ein komischer Befund. Möglicher Grund: Einparteien-Minderheitsregierungen sind stabiler, als welche mit mehr Mitgliedern, wo der Sitzanteil entsprechend größer wäre
Auch: Saalfeld zielt auf Smith 2004 ab: one party in GB und early elections. kann ich darüber was sagen?-->

Dagegen kann für die Anzahl der Kabinettsparteien und dafür, ob die Partei mit der größten Verhandlungsmacht Teil der Regierung ist, ausgesagt werden, dass dies Faktoren sind, die die Wahrscheinlichkeit eines vorzeitigen Regierungsscheiterns erhöhen.
Für erstere wird aus dem Modell ersichtlich, dass mit einer zunehmenden Anzahl von Parteien im Kabinett auch das Regierungsscheitern wahrscheinlicher wird. Für jede neue Partei, die Teil eines Kabinetts ist, 

### Modell 2: Präferenzen

```{r}
# sbPref
sbPreferences <- subset(BergmannERDDA.f, select = c("discr2019", "abs_dur", "pref_range",
                                                  "median_party_cab", "cons_cab",
                                                  "soc_cab", "parl_pref_range"))

# model fit for part II: PREFERENCES 
coxPH.PREF <- coxph(data = sbPreferences, Surv(time = sbPreferences$abs_dur, event = sbPreferences$discr2019, type = "right") ~ . - abs_dur - discr2019)
summary(coxPH.PREF)
cox.zph(coxPH.PREF)
car::vif(coxPH.PREF)
```



### Modell 3: Institutionen

```{r}
# sbInst
sbInstit <- subset(BergmannERDDA.f, select = c("discr2019", "abs_dur", "invest", "cabunan", "pm_pow", "pm_diss_pow", "erdda_bicam", "erdda_semip"))

# model fit for part III: INSTITUTIONS 
coxPH.INST <- coxph(data = sbInstit, Surv(time = sbInstit$abs_dur, event = sbInstit$discr2019, type = "right") ~ . 
                    - abs_dur - discr2019 - pm_pow - pm_diss_pow)
summary(coxPH.INST)
cox.zph(coxPH.INST)
car::vif(coxPH.INST)
```



### Modell 4: Bargaining Environment

```{r}
# sbBarg
sbBarg <- subset(BergmannERDDA.f, select = c("discr2019", "abs_dur", "same_pm", "erdda_barg_dur", "max_poss_dur", "coal_cab"))

# model fit for part IV: BARGAINING 
coxPH.BARG <- coxph(data = sbBarg, Surv(time = sbBarg$abs_dur, event = sbBarg$discr2019, type = "right") ~ . - abs_dur - discr2019)
summary(coxPH.BARG)
cox.zph(coxPH.BARG)
car::vif(coxPH.BARG)
```



### Modell 5: Kritische (exogene) Events

```{r}

# sbCrit
sbCrit.Abs <- subset(BergmannERDDA.f, select = c("discr2019", "abs_dur", "elect_volat", "inflation_Abs", "unemploy_Abs", "soc_cab", "cons_cab"))

# model fit for part V: CRITICAL EVENTS 
coxPH.CRIT.ABS <- coxph(data = sbCrit.Abs, Surv(time = sbCrit.Abs$abs_dur, event = sbCrit.Abs$discr2019, type = "right") ~ elect_volat + unemploy_Abs + inflation_Abs - soc_cab - cons_cab)

summary(coxPH.CRIT.ABS)
cox.zph(coxPH.CRIT.ABS)
# with interaction effects, the ph assumption is not met
# without this, it is very closely met, but nothing is significant

car::vif(coxPH.CRIT.ABS)
# with interactions, VIFs are unnaturally high
# without interactions, VIFs are even higher...
```




### Modell des best fit

Abschließend wird hier noch, wie zu Beginn angekündigt, das Modell des best fit gezeigt. Dieses Modell wurde in R mit Hilfe der stepAIC-Funktion errechnet. Diese Funktion errechnet jenes Modell, das den niedrigsten AIC-Wert aufweist - und welches daher die bestmögliche Passung auf die vorhandenen Daten abbildet. Es ist dafür jedoch erforderlich, dass alle mit NA gekennzeichneten Observationen vor der Durchführung zunächst aus den Daten entfernt werden mussten. Die genutzten Daten entsprechen hierbei einer Kombination aus allen zuvor für die Einzeluntersuchungen erstellten Subsets. Nach entsprechender Behandlung bleiben im kombinierten Subset für den best fit von zuvor 207 Observationen für alle Minderheitsregierungen noch 135 Observationen übrig - mit diesen wurde im Folgenden weiter gearbeitet.

Bevor auf die Ergebnisse eingegangen wird, soll an dieser Stelle noch kurz etwas zur Methodik, bzw. zur Vorgehensweise, bei der Verwendung der schrittweisen Ermittlung des best fit-Modells erläutert werden. Zunächst wurden, wie bereits erwähnt, alle NA-Werte ausgeschlossen. Der auf diese Weise bereinigte Datensatz wurde dann zunächst in zwei "Vormodellen" beinhaltet, die sich wie folgt zusammengesetzt haben:

+ ein *"Nullmodell"*: hier wurde ein "leeres" Cox Proportional Hazards-Modell geschätzt, in welchem keine unabhängigen Variablen beinhaltet werden. Dieses Modell ist der Ausgangspunkt der Berechnung.
+ ein *"Vollmodell"*: dieses Modell beinhaltet alle in der Untersuchung der Einzelmodelle bisher verwendeten Variablen und bildet, bildhaft gesprochen, die "Obergrenze" für die durchzuführende schrittweise Berechnung.

```{r config sbAll, include=FALSE}
# first step: generate one big subset out of the others
sbAll <- cbind(sbBarg, sbInstit, sbPreferences, sbStructure, sbCrit.Abs)

#this HAS to be executed in this order!
sbAll[c(7, 8, 15, 16, 22, 23, 29, 30)] <- list(NULL)
sbAll[21] <- NULL
sbAll[c(25, 26)] <- list(NULL)

# get rid of NAs
sbAll <- na.omit(sbAll)
```

```{r best fit, echo=FALSE}
# null model and full model
modNull <- coxph(data = sbAll, Surv(time = sbAll$abs_dur, event = sbAll$discr2019, type = "right") ~ 1)
modFull <- coxph(data = sbAll, Surv(time = sbAll$abs_dur, event = sbAll$discr2019, type = "right") ~ . - abs_dur - discr2019)

# step function for acquiring best fit
# stepAIC(modNull, scope = list(upper = modFull), direction = "both")

# best fit as object with summary and test for ph assumption
best.fit <- coxph(formula = Surv(time = sbAll$abs_dur, event = sbAll$discr2019,type = "right") ~ 
                    cabunan + effec_parties_parl + erdda_bicam + 
                    pref_range + parl_pref_range + unemploy_Abs + num_cabparties + 
                    elect_volat + median_party_cab + erdda_semip, data = sbAll)
extractAIC(best.fit)
summary(best.fit)
cox.zph(best.fit)
car::vif(best.fit)
```

Das so mittels der step-Funktion erhaltene, am besten passende Modell wurde daraufhin extrahiert und, wie zuvor bei den Einzelmodellen auch, bezüglich des AIC-Werts (best fit bei gerundet 696), der Proportional Hazards-Annahme und der VIF-Faktoren überprüft. Für die VIF-Faktoren konnte hier festgestellt werden, dass diese sich im Rahmen bewegen (alle Faktoren unter dem gängigen Grenzwert 10).
Für die PH-Assumption, welche von der schrittweisen Berechnung des Modells durch die Funktion stepAIC nicht beachtet wird, konnte festgestellt werden, dass 











```{r tidy table for best fit && survival plot for estimated model, echo=F}
tidyBestFit <- tidy(best.fit, exponentiate = T, conf.level = 0.95) %>% 
  mutate(signif = stars.pval(p.value))

kbl(tidyBestFit) %>% 
  kable_classic()

# plot(cox.zph(best.fit))
# cant see pattern, which is good
```


# Fazit


# Literaturverzeichnis

+ Grambsch, Patricia; Therneau, Terry (1994): *Proportional hazards tests and diagnostics based on weighted residuals*, Biometrika, 81, S. 515-526.

+ Saalfeld, Thomas (2008): *Institutions, Chance, and Choices: The Dynamics of Cabinet Survival*, in: Strøm, Kaare; Bergman, Torbjörn; Müller, Wolfgang (eds., 2008): *Cabinets and Coalition Bargaining: The Democratic Life Cycle in Western Europe*, Oxford, Oxford University Press, S. 327-368.

+ Strøm, Kaare (1984): *Minority Governments in Parliamentary Democracies. The Rationality of Nonwinning Cabinet Solutions*, Comparative Political Studies, Vol. 17, Iss. 2, S. 199-227.

+ Strøm, Kaare (1990): *Minority Government and Majority Rule*, Cambridge, Cambridge University Press.

+ Lupia/Strøm 1995 und 2008 (chap 2)

+ Diermeier/Stevenson 1999

+ Grofman/van Roozendal 1997


# Abbildungsverzeichnis

```{r baseline survival function, echo=F}
plot(survfit(Surv(time = BergmannERDDA.f$abs_dur, event = BergmannERDDA.f$discr2019, type = "right")~1))
```


```{r heatmap I: structure, echo=F}
# na.omit
sbStructure <- na.omit(sbStructure)

# corrmatrix
corStructure <- round(cor(sbStructure), 2)

# heatmap (interactive)
d3heatmap::d3heatmap(corStructure, Rowv = FALSE, Colv=FALSE)
# exclude coal_cab (correlates: .84 with num_cabparties) - rest is fine

```


```{r heatmap II: preferences, echo=FALSE}
corPreferences <- round(cor(sbPreferences), 2)

# heatmap
# corrplot(corPreferences, type = "upper", method = "number")
d3heatmap::d3heatmap(corPreferences, Rowv = FALSE, Colv=FALSE)
# max correlation is -.45, no exclusion
```






```{r survival probability estimated: best.fit, echo=F}
# survival probability estimated by model
ggsurvplot(data = sbAll, survfit(best.fit),
           ggtheme = theme_minimal()) + 
  ggtitle(label = "Überlebenswahrscheinlichkeitvon Regierungen",
          subtitle = "geschätzt durch Modell des best fit")
```



# Eigenständigkeitserklärung


Ich erkläre hiermit, dass ich die Hausarbeit mit dem Titel "Explorative Datenanalyse: Faktoren der (In-)Stabilität von Minderheitsregierungen in Europa" im Rahmen der Lehrveranstaltung _"Vergleichende Politikwissenschaft II: Modelle der Koalitionsforschung und ihre empirische Anwendung"_ im Wintersemester 2020/2021 selbständig angefertigt, keine anderen Hilfsmittel als die im Quellen- und Literaturverzeichnis genannten benutzt und alle aus den Quellen und der Literatur wörtlich oder sinngemäß übernommenen Stellen als solche gekennzeichnet habe.



Bamberg, den XX.YY.ZZZZ



Unterschrift Florian Wisniewski


